<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Movimentando Esferas com Teclas</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }

        canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
    </style>
</head>
<body>
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script>
        var canvas = document.createElement("canvas");
        document.body.appendChild(canvas);

        var engine = new BABYLON.Engine(canvas, true);
        var scene = new BABYLON.Scene(engine);
		
		// Som de fundo
        //const music = new BABYLON.Sound("musica", "sons/torcida.mp3", scene, null, { loop: true, autoplay: true });
        // Som do chute
	    const colisao = new BABYLON.Sound("colisao", "sons/metal2.mp3", scene);
		// Som da torcida GOOL
	    //const gol = new BABYLON.Sound("gol", "sons/gol1.wav", scene);


	   	// Configurações da câmera
        const camera = new BABYLON.FreeCamera("camera", new BABYLON.Vector3(0, 35, -40), scene);
		camera.setTarget(BABYLON.Vector3.Zero());
        //camera.attachControl(canvas, true);

	    // Chao
		var wg = 70;
		var hg = 40;
        const grdMat = new BABYLON.StandardMaterial("grdMat");
		grdMat.emissiveColor = new BABYLON.Color3(0, 1, 0);
       // grdMat.diffuseTexture = new BABYLON.Texture("texturas/gramaFut7.png");
        const ground = BABYLON.MeshBuilder.CreateGround("ground", {width: wg, height: hg}, scene);
		ground.material = grdMat;

        // Criando esferas		
		const Mat1 = new BABYLON.StandardMaterial("Mat1", scene);
	    Mat1.emissiveColor = new BABYLON.Color3(1, 0, 0);
        var sphere1 = BABYLON.MeshBuilder.CreateSphere("sphere1", { diameter: 1 }, scene);
		sphere1.material = Mat1;
		sphere1.position.y = 1;
        sphere1.position.x = -wg/2;
		
		const Mat2 = new BABYLON.StandardMaterial("Mat2", scene);
	    Mat2.emissiveColor = new BABYLON.Color3(0, 0, 1);
        var sphere2 = BABYLON.MeshBuilder.CreateSphere("sphere2", { diameter: 1 }, scene);
		sphere2.material = Mat2;
        sphere2.position.y = 1;
        sphere2.position.x = wg/2;

        // Adicionando eventos de teclado
        var inputMap = {};
        window.addEventListener("keydown", function (event) {
            inputMap[event.key] = event.type === "keydown";
        });
        window.addEventListener("keyup", function (event) {
            inputMap[event.key] = event.type === "keydown";
        });
        var v1 = 0.15;
		var v2 = 0.20;
        // Render Loop
        engine.runRenderLoop(function () {
            if (inputMap["s"]) {
			   if  (sphere1.position.z > -hg/2) sphere1.position.z -= v1;  
			   else sphere1.position.z = hg/2; 
			}
            if (inputMap["w"]){
    		   if (sphere1.position.z < hg/2) sphere1.position.z += v1;  
			   else sphere1.position.z = -hg/2; 
			}
            if (inputMap["d"]){
			   if (sphere1.position.x < wg/2) sphere1.position.x += v1; 
			   else sphere1.position.x = -wg/2; 
			}
            if (inputMap["a"]){
			   if (sphere1.position.x > -wg/2) sphere1.position.x -= v1;  
			   else sphere1.position.x = wg/2;
			}
			
            if (inputMap["ArrowDown"]){ 
			   if (sphere2.position.z > -hg/2) sphere2.position.z -= v2;  
			   else sphere2.position.z = hg/2;
			}
			if (inputMap["ArrowUp"]){
    		   if (sphere2.position.z < hg/2) sphere2.position.z += v1;  
			   else sphere2.position.z = -hg/2; 
			}
            if (inputMap["ArrowRight"]){
			   if (sphere2.position.x < wg/2) sphere2.position.x += v1; 
			   else sphere2.position.x = -wg/2; 
			}
            if (inputMap["ArrowLeft"]){
			   if (sphere2.position.x > -wg/2) sphere2.position.x -= v1;  
			   else sphere2.position.x = wg/2;
			}
            scene.render();
        });
		
        // Verificar colisão
        scene.registerBeforeRender(function () {
            if (sphere1.intersectsMesh(sphere2, true)) {
 				sphere1.position.x = -wg/2;
 				sphere1.position.z = 0;
 				sphere2.position.x = wg/2;
				sphere2.position.z = 0;
				colisao.play();
            }
        });
        // Resize
        window.addEventListener("resize", function () {
            engine.resize();
        });
    </script>
</body>
</html>

